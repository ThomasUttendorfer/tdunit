.head 0 +  Application Description: tdunit framework - a unit-test framework for Gupta SqlWindows TeamDeveloper
Contains the base-class _UnitTestBase from which every Unit-Test-Class must derive from.
Contains also a Test-Runner which runs all the tests
.head 1 -  Outline Version - 4.0.35
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000470100 002C000000020000 0003000000FFFFFF FFFFFFFFFFF8FFFF
0040: FFE1FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left: -0.013"
.head 3 -  Top: 0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? No
.head 3 -  Left: 4.15"
.head 3 -  Top: 1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left: 0.575"
.head 3 -  Top: 0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left: 6.388"
.head 3 -  Top: 0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 2 -  Edit Fields Read Only On Disable? No
.head 1 +  Libraries
.head 2 -  File Include: cdk.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 4 -  Number: SAM_NewUnitTestResult = SAM_User + 1
.head 4 -  String: sAppName = 'TDUnit'
.head 3 +  Enumerations
.head 4 +  Enum: eUnitTestStatus
.head 5 +  Attributes
.head 6 -  GUID: {FFAA3D7B-5DC5-4BBF-9CC7-B11C4684F382}
.head 6 -  Help String:
.head 6 -  Help Context: 0
.head 5 -  Item: Neutral = 0
.head 5 -  Item: Succeeded = 1
.head 5 -  Item: Failed = 2
.head 5 -  Item: Ignored = 3
.head 2 -  Resources
.head 2 +  Variables
.head 3 -  Boolean: bOverrideIgnore
.head 3 -  Boolean: bSkipSlowTests
.head 3 -  Boolean: bRunUnitTestInternalFunctionTests
.head 2 +  Internal Functions
.head 3 +  Function: RunUnitTests
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  FunctionalVar: cLog
.head 6 -  Class: UnitTestLog
.head 5 -  Window Handle: hWndNotify
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  FunctionalVar: cUnitTest
.head 6 -  Class: _UnitTestBase
.head 5 -  String: sMsg
.head 5 -  FunctionalVar: acUnitTestClasses[*]
.head 6 -  Class: cdkClass
.head 5 -  Number: nCountUnitTestClasses
.head 5 -  Number: nIdxUnitTestClasses
.head 5 -  String: sUnitTestClassName
.head 5 -  String: sItemText
.head 5 -  String: sComment
.head 5 -  String: sUnitTestClassText
.head 4 +  Actions
.head 5 -  Call cLog.SetNotifyWindowHandle( hWndNotify )
.head 5 -  ! Retrieve all UnitTest-Classes in curent outline
.head 5 -  Set nCountUnitTestClasses = GetUnitTestClasses( acUnitTestClasses, cLog )
.head 5 -  ! Iterate through all UnitTest classes and call their "RunTest"-memberfunction
.head 5 +  While ( nIdxUnitTestClasses < nCountUnitTestClasses )
.head 6 -  ! Get Name of Class
.head 6 -  Set sUnitTestClassName = acUnitTestClasses[nIdxUnitTestClasses].GetName()
.head 6 -  ! Get Text of Class (includes inline comment if present)
.head 6 -  Set sUnitTestClassText = acUnitTestClasses[nIdxUnitTestClasses].GetText()
.head 6 -  Set sComment = StripComment( sUnitTestClassText )
.head 6 +  If ( (SalStrScan(sComment, '__Ignore') > -1) AND ( NOT bOverrideIgnore) )
.head 7 -  Call cLog.Add( eUnitTestStatus.Ignored, sUnitTestClassText, '', 'Ignored UnitTest class' )
.head 6 +  Else
.head 7 +  If ( (SalStrScan(sComment, '__SlowTest') > -1) AND ( bSkipSlowTests) )
.head 8 -  Call cLog.Add( eUnitTestStatus.Ignored, sUnitTestClassText, '', 'Ignored SlowTest UnitTest class' )
.head 7 +  Else
.head 8 -  ! Instanciate this class
.head 8 -  Set cUnitTest = SalObjCreateFromString( sUnitTestClassName )
.head 8 -  Call cUnitTest.__SetUnitTestLog(cLog)
.head 8 -  ! Set nType = SalCompileAndEvaluate( 'Set cUnitTest = new ' || sUnitTestClassName, nError, nErrorPos, nReturn, sReturn, dtReturn, hWndReturn, FALSE, SalContextCurrent() )
.head 8 +  If ( cUnitTest = OBJ_Null )
.head 9 -  Call cLog.Add( FALSE, '', 'RunTests', 'Could not instanciate UnitTest class ' || sUnitTestClassName )
.head 8 -  Call cUnitTest.__RunTests(acUnitTestClasses[nIdxUnitTestClasses])
.head 6 -  Set nIdxUnitTestClasses = nIdxUnitTestClasses + 1
.head 5 -  Set sMsg = sMsg
.head 3 +  Function: GetUnitTestClasses
.head 4 -  Description: retrieves all classes of the current outline which names begin with 'UnitTest'
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 +  FunctionalVar: acUnitTestClasses[*]
.head 6 -  Class: cdkClass
.head 6 -  ! Used as receive-parameter
.head 5 -  FunctionalVar: cLog
.head 6 -  Class: UnitTestLog
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  FunctionalVar: cApp
.head 6 -  Class: cdkApplication
.head 5 -  FunctionalVar: acClasses[*]
.head 6 -  Class: cdkClass
.head 5 -  Number: nCountClasses
.head 5 -  Number: nIdx
.head 5 -  Number: nCountUnitTestClasses
.head 5 -  Boolean: bIsDerivedFromUnitTestBase
.head 5 -  Boolean: bEndsWithTests
.head 5 -  String: sItemText
.head 4 +  Actions
.head 5 -  ! Reset receive parameter
.head 5 -  Call SalArraySetUpperBound( acUnitTestClasses, 1, -1 )
.head 5 -  ! get handle of the current outline ( SalOutlineCurrent() is an officially undocumented function)
.head 5 -  Call cApp.InitApp( SalOutlineCurrent() )
.head 5 -  ! retrieve all classes
.head 5 -  Set nCountClasses = cApp.EnumClassObjects( acClasses )
.head 5 -  ! exctract all classes which name ends with 'Tests' or which are derived from _UnitTestBase
.head 5 +  While ( nIdx < nCountClasses )
.head 6 -  Set bEndsWithTests= SalStrRightX( acClasses[nIdx].GetName(  ), 5) = 'Tests'
.head 6 -  Set bIsDerivedFromUnitTestBase = __IsDerivedFromBaseClass( acClasses[nIdx], '_UnitTestBase' )
.head 6 +  If ( bIsDerivedFromUnitTestBase )
.head 7 +  If ( acClasses[nIdx].GetName() = 'UnitTestInternalFunctionTests' AND (NOT bRunUnitTestInternalFunctionTests) )
.head 8 -  ! do nothing
.head 7 +  Else
.head 8 -  Set acUnitTestClasses[nCountUnitTestClasses] = acClasses[nIdx]
.head 8 -  Set nCountUnitTestClasses = nCountUnitTestClasses + 1
.head 7 +  If ( cLog != OBJ_Null )
.head 8 +  If ( NOT bEndsWithTests )
.head 9 -  Call cLog.Add( eUnitTestStatus.Failed, acClasses[nIdx].GetName(), '', 'UnitTest classname must end with "Tests"' )
.head 6 +  If ( cLog != OBJ_Null )
.head 7 +  If ( bEndsWithTests AND (NOT bIsDerivedFromUnitTestBase) )
.head 8 -  Call cLog.Add( eUnitTestStatus.Failed, acClasses[nIdx].GetName(), '', 'UnitTest must be derived from _UnitTestBase' )
.head 6 -  Set nIdx = nIdx + 1
.head 5 -  Return nCountUnitTestClasses
.head 3 +  Function: GetUnitTestFunctions
.head 4 -  Description: retrieves all UnitTest-functions within a specified class
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  FunctionalVar: cUnitTestClass
.head 6 -  Class: cdkClass
.head 5 +  String: asUnitTestFunctions[*]
.head 6 -  ! Receive String Array
.head 5 -  Receive Boolean: bIsGetContextPresent 
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nCountUnitTestFunctions
.head 5 -  Number: nCountFunctions
.head 5 -  String: asFunctionNames[*]
.head 5 -  Number: nIdx
.head 4 +  Actions
.head 5 -  ! initialize receive-parameter
.head 5 -  Call SalArraySetUpperBound( asUnitTestFunctions, 1, -1 )
.head 5 -  Set bIsGetContextPresent = FALSE
.head 5 -  ! retrieve all member function names from UnitTest class
.head 5 -  Set nCountFunctions = cUnitTestClass.EnumFunctions( asFunctionNames )
.head 5 -  ! all functions but SetUp, TearDown and GetContext and functions which begin with double underschore should be test functions
.head 5 +  While ( nIdx < nCountFunctions )
.head 6 +  If ( (asFunctionNames[nIdx] != 'SetUp') AND (asFunctionNames[nIdx] != 'TearDown') AND (asFunctionNames[nIdx] != 'GetContext') AND (SalStrLeftX(asFunctionNames[nIdx], 2) != '__') )
.head 7 -  Set asUnitTestFunctions[nCountUnitTestFunctions] = asFunctionNames[nIdx]
.head 7 -  Set nCountUnitTestFunctions = nCountUnitTestFunctions + 1
.head 6 +  If ( asFunctionNames[nIdx] = 'GetContext' )
.head 7 -  Set bIsGetContextPresent = TRUE
.head 6 -  Set nIdx = nIdx + 1
.head 5 -  Return nCountUnitTestFunctions
.head 3 +  Function: __IsDerivedFromBaseClass
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  FunctionalVar: cClass
.head 6 -  Class: cdkClass
.head 5 -  String: sBaseClassName
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: asBaseClasses[*]
.head 5 -  Number: nCountBaseClasses
.head 5 -  Number: nIdx
.head 4 +  Actions
.head 5 -  Set nCountBaseClasses = cClass.EnumBaseClasses( asBaseClasses )
.head 5 +  While ( nIdx < nCountBaseClasses )
.head 6 +  If ( asBaseClasses[nIdx] = sBaseClassName )
.head 7 -  Return TRUE
.head 6 -  Set nIdx = nIdx + 1
.head 5 -  Return FALSE
.head 3 +  Function: StripComment
.head 4 -  Description: Call with a string retrieved by cdkXX.GetName() to strip off comment.
Returns the comment.
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Receive String: rsItemName
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sComment
.head 5 -  Number: nPos
.head 4 +  Actions
.head 5 -  Set nPos = SalStrScan( rsItemName, '!' )
.head 5 +  If ( nPos > -1 )
.head 6 -  Set sComment = SalStrTrimX(SalStrRightX( rsItemName, SalStrLength( rsItemName ) - (nPos + 1)))
.head 6 -  Set rsItemName = EliminateWhitespacesX( SalStrLeftX( rsItemName, nPos ) )
.head 5 -  Return sComment
.head 3 +  Function: StrReplaceSubstringX
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sMain
.head 5 -  String: sFind
.head 5 -  String: sReplace
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nPos
.head 5 -  String: sOut
.head 5 -  Number: rnNextPos
.head 4 +  Actions
.head 5 -  Call StrReplaceSubstringBeginningAt(sMain, sFind, sReplace, 0, sOut, rnNextPos )
.head 5 -  Return sOut
.head 3 +  Function: StrReplaceSubstring
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sMain
.head 5 -  String: sFind
.head 5 -  String: sReplace
.head 5 -  Receive String: rsOut
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  ! Number: nPos
.head 5 -  ! Boolean: bReplaced
.head 5 -  Number: rnNextPos
.head 4 +  Actions
.head 5 -  Return StrReplaceSubstringBeginningAt( sMain, sFind, sReplace, 0, rsOut, rnNextPos )
.head 3 +  Function: StrReplaceSubstringBeginningAt
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sMain
.head 5 -  String: sFind
.head 5 -  String: sReplace
.head 5 -  Number: nBeginningAt
.head 5 -  Receive String: rsOut
.head 5 -  Receive Number: rnNextPos
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nPos
.head 5 -  Boolean: bReplaced
.head 5 -  Number: nLenMain
.head 4 +  Actions
.head 5 +  If ( nBeginningAt = NUMBER_Null )
.head 6 -  Set nBeginningAt = 0
.head 5 +  Else If ( nBeginningAt < 0 )
.head 6 -  Set nBeginningAt = 0
.head 5 -  Set nBeginningAt = SalNumberRound( nBeginningAt )
.head 5 -  Set rnNextPos = 0
.head 5 -  !
.head 5 -  Set rsOut = sMain
.head 5 -  Set nLenMain = SalStrLength( sMain )
.head 5 +  If ( nBeginningAt >= nLenMain )
.head 6 -  Return FALSE
.head 5 +  If ( sFind  )
.head 6 +  If ( nBeginningAt > 0 )
.head 7 -  Set nPos = SalStrScan( SalStrRightX(sMain, nLenMain - nBeginningAt ), sFind )
.head 7 +  If ( nPos > -1 )
.head 8 -  Set nPos = nPos + nBeginningAt
.head 6 +  Else
.head 7 -  Set nPos = SalStrScan( sMain, sFind )
.head 6 +  If ( nPos > -1 )
.head 7 -  Set rsOut = SalStrLeftX( sMain, nPos ) || sReplace || SalStrRightX( sMain, nLenMain - nPos - SalStrLength( sFind ) )
.head 7 -  Set rnNextPos = nPos + SalStrLength( sReplace )
.head 7 -  Set bReplaced = TRUE
.head 5 -  Return bReplaced
.head 3 +  Function: EliminateWhitespacesX
.head 4 -  Description: removes ' ', TAB, CR, LF
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sIn
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sOut
.head 4 +  Actions
.head 5 -  Set sOut = sIn
.head 5 -  ! Space
.head 5 -  Set sOut = StrReplaceEverySubstringX( sOut, ' ', '' )
.head 5 -  ! TABL
.head 5 -  Set sOut = StrReplaceEverySubstringX( sOut, SalNumberToChar(9), '' )
.head 5 -  ! CR
.head 5 -  Set sOut = StrReplaceEverySubstringX( sOut, SalNumberToChar(13), '' )
.head 5 -  ! LF
.head 5 -  Set sOut = StrReplaceEverySubstringX( sOut, SalNumberToChar(10), '' )
.head 5 -  Return sOut
.head 3 +  Function: StrReplaceEverySubstringX
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sMain
.head 5 -  String: sFind
.head 5 -  String: sReplace
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sOut
.head 5 -  Number: nNextPos
.head 4 +  Actions
.head 5 -  Set sOut = sMain
.head 5 -  While (StrReplaceSubstringBeginningAt( sOut, sFind, sReplace, nNextPos, sOut, nNextPos ) )
.head 5 -  Return sOut
.head 3 +  Function: AddGetContext
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  FunctionalVar: cClass
.head 6 -  Class: cdkClass
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  FunctionalVar: cFnc
.head 6 -  Class: cdkFunction
.head 5 -  FunctionalVar: cAction
.head 6 -  Class: cdkActionBlock
.head 5 -  String: sFncName
.head 5 -  Boolean: bOk
.head 5 -  FunctionalVar: cApp
.head 6 -  Class: cdkApplication
.head 4 +  Actions
.head 5 -  Set sFncName = 'GetContext'
.head 5 -  Set bOk = cClass.AddFunction( sFncName, cFnc )
.head 5 +  If ( bOk )
.head 6 -  Set bOk = cFnc.SetReturnType( CDK_IT_String )
.head 5 +  If ( bOk )
.head 6 -  Set bOk = cFnc.GetActions( cAction )
.head 5 +  If ( bOk )
.head 6 -  Set bOk = cAction.InsertAfter( 'Return SalContextCurrent()' )
.head 5 -  Return bOk
.head 3 +  Function: RemoveGetContext
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  FunctionalVar: cClass
.head 6 -  Class: cdkClass
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  FunctionalVar: cFnc
.head 6 -  Class: cdkFunction
.head 5 -  FunctionalVar: cAction
.head 6 -  Class: cdkActionBlock
.head 5 -  String: sFncName
.head 5 -  Boolean: bOk
.head 4 +  Actions
.head 5 -  Set sFncName = 'GetContext'
.head 5 -  Set bOk = cClass.RemoveFunction( sFncName )
.head 5 -  Return bOk
.head 2 -  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 2571802201
0000: B3020000D7010000 0000000000000000 0200000200FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F9D003C00 000A5F004572726F
0040: 7242617300658A01 00000D00001E0019 0000020001A20405 00000600A6017300
0060: 00680001000019B3 0019008401A20600 00003DA600011A00 003200002C001900
0080: 01A26107000000A6 8F00010006004B00 0000194B0001A208 D8000000A6A30001
00A0: 0000016400000004 0000020002A20409 0000F600A66C0001 0068B00000000400
00C0: 86020A0000003DA6 00011B006C0000AC 00040002610B0000 00A6CF0001060070
00E0: 000000040B0003A2 040CD8000000A6B3 000100C174000000 049A00020D00F600
0100: A66C00010078B000 0000040086020E00 00003DA600011B00 7C0000AC00040003
0120: 610F000000A6CF00 011600800000046B 000310D8000000A6 B3000100C1840000
0140: 0019120001A21100 00F600A668000100 000180805B000000 010000000763646B
0160: 497465806DDE0000 000700DE0004D000 0102A206FE008380 010000007F04B300
0180: 0400B60207002156 03730000019A0000 08002C00190001A2 6D0900568F000100
01A0: 060021000000194B 0001A20ADB0056A3 00010000C13A0000 0004DA00030BF600
01C0: 566C0001003EB000 00000400B6030C00 3D5600011B004200 002C00190001A26D
01E0: 0D00568F00010006 00
.enddata
.head 3 +  Functional Class: _UnitTestBase
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  ! Boolean: abAssertFailures[*]
.head 5 -  ! String: asAssertMsgs[*]
.head 5 -  ! Number: nAssertCount
.head 5 -  String: asTests[*]
.head 5 -  FunctionalVar: cLog
.head 6 -  Class: UnitTestLog
.head 5 -  String: sCurrentClassName
.head 5 -  String: sCurrentFunctionName
.head 4 +  Functions
.head 5 -  ! private memberfunctions (more or less)
.head 5 +  Function: __GetContext
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ..GetContext()
.head 5 +  Function: __SetUp
.head 6 -  Description: Wird vor jedem Execute aufgerufen, setzt einen Zustand, wenn nötig
Ruft die ggf. abgeleitete Funktion TestFixture().
Returnt diese FALSE, wird der Test abgebrochen
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Receive String: sErrorMsg
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If ( NOT ..SetUp( sErrorMsg ) )
.head 8 +  If ( NOT sErrorMsg )
.head 9 -  Set sErrorMsg = 'TestFixture failed'
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: __TearDown
.head 6 -  Description: Wird nach jedem Execute aufgerufen, setzt einen Zustand, wenn nötig zurück
Ruft die ggf. abgeleitete Funktion TearDown().
Returnt diese FALSE, wird der Test abgebrochen
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Receive String: sErrorMsg
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If ( NOT ..TearDown( sErrorMsg ) )
.head 8 +  If ( NOT sErrorMsg )
.head 9 -  Set sErrorMsg = 'TearDown failed'
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: __LogAdd
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nStatus
.head 7 -  String: sMsg
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call cLog.Add( nStatus, sCurrentClassName, sCurrentFunctionName, sMsg )
.head 5 +  Function: __RunTests
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  FunctionalVar: cUnitTestClass
.head 8 -  Class: cdkClass
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nTestCount
.head 7 -  Number: nIdx
.head 7 -  Number: nType
.head 7 -  Number: nError
.head 7 -  Number: nErrorPos
.head 7 -  Number: nReturn
.head 7 -  String: sReturn
.head 7 -  Date/Time: dtReturn
.head 7 -  Window Handle: hWndReturn
.head 7 -  String: sMsg
.head 7 -  String: asUnitTestFunctions[*]
.head 7 -  Number: nCountUnitTestFunctions
.head 7 -  String: sUnitTestFunctionName
.head 7 -  String: sContext
.head 7 -  Boolean: bIsGetContextPresent
.head 6 +  Actions
.head 7 -  Set sCurrentClassName = cUnitTestClass.GetName()
.head 7 -  Set nCountUnitTestFunctions = GetUnitTestFunctions( cUnitTestClass, asUnitTestFunctions, bIsGetContextPresent )
.head 7 +  If ( NOT bIsGetContextPresent )
.head 8 -  Call AddGetContext( cUnitTestClass )	! Hilfe, um die Fkt einzubauen
.head 7 +  If ( nCountUnitTestFunctions = 0 )
.head 8 -  Call cLog.Add( eUnitTestStatus.Ignored, sCurrentClassName, '', 'UnitTest class does not implement any testfunction' )
.head 7 +  If ( NOT bIsGetContextPresent )
.head 8 -  Call cLog.Add( eUnitTestStatus.Failed, sCurrentClassName, '', 'Every UnitTest class must implement GetContext()' )
.head 8 -  Return FALSE
.head 7 +  While ( nIdx <  nCountUnitTestFunctions )
.head 8 +  If ( __SetUp(sMsg) )
.head 9 -  Set sCurrentFunctionName = asUnitTestFunctions[nIdx]
.head 9 -  Set sUnitTestFunctionName = sCurrentFunctionName || '()'
.head 9 -  Set sContext = __GetContext(  )
.head 9 -  Set nType = SalCompileAndEvaluate( sUnitTestFunctionName, nError, nErrorPos, nReturn, sReturn, dtReturn, hWndReturn, TRUE, sContext )
.head 9 +  If ( nError )
.head 10 -  Set sMsg = 'Error in testfunction "' || asUnitTestFunctions[nIdx] || '"
ErrorCode = ' || SalNumberToStrX( nError, 0 ) || '
ErrorPos = ' || SalNumberToStrX( nErrorPos, 0 )
.head 10 -  Call __LogAdd( eUnitTestStatus.Failed, sMsg )
.head 9 +  If ( NOT __TearDown( sMsg ) )
.head 10 -  Set sMsg = 'Error in TearDown()
' || sMsg
.head 10 -  Call __LogAdd( eUnitTestStatus.Failed, sMsg )
.head 8 +  Else
.head 9 -  Set sMsg = 'Error in SetUp()
' || sMsg
.head 9 -  Call __LogAdd( eUnitTestStatus.Failed, sMsg )
.head 8 -  Set nIdx = nIdx + 1
.head 7 -  Return TRUE
.head 5 +  Function: __SetUnitTestLog
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  FunctionalVar: cUnitTestLog
.head 8 -  Class: UnitTestLog
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set cLog = cUnitTestLog
.head 5 -  ! must be implemented for every unittest class in exactly this way
.head 5 +  Function: GetContext
.head 6 -  Description: Must be overwritten in descendant class!
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return SalContextCurrent(  )
.head 5 -  ! Call before and after each testfunction
.head 5 +  Function: SetUp
.head 6 -  Description: Virtuelle Funktion - kann in abgeleiteten Klassen bei Bedarf überschrieben werden.
Im Fehlerfall sollte der Receive-Parameter sErrorMsg geeignet gesetzt werden
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Receive String: sErrorMsg
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: TearDown
.head 6 -  Description: Virtuelle Funktion - kann in abgeleiteten Klassen bei Bedarf überschrieben werden.
Im Fehlerfall sollte der Receive-Parameter sErrorMsg geeignet gesetzt werden
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Receive String: sErrorMsg
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 -  ! Asserts
.head 5 +  Function: AssertIsEmptyString
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sIn1
.head 7 -  String: sMsg
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If ( sIn1 = '' )
.head 8 -  Call __LogAdd( eUnitTestStatus.Succeeded, 'String is empty' )
.head 7 +  Else
.head 8 +  If ( NOT sMsg )
.head 9 -  Set sMsg = 'Strings is not empty
String1 = "' || sIn1|| '"'
.head 8 -  Call __LogAdd( eUnitTestStatus.Failed, sMsg )
.head 5 +  Function: AssertAreEqualStrings
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sIn1
.head 7 -  String: sIn2
.head 7 -  String: sMsg
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If ( sIn1 = sIn2 )
.head 8 -  Call __LogAdd( eUnitTestStatus.Succeeded, 'Strings are equal' )
.head 7 +  Else
.head 8 +  If ( NOT sMsg )
.head 9 -  Set sMsg = 'Strings are not equal.
String 1 = "' || sIn1|| '" 
String 2 = "' || sIn2 || '"'
.head 8 -  Call __LogAdd( eUnitTestStatus.Failed, sMsg )
.head 5 +  Function: AssertAreNotEqualStrings
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sIn1
.head 7 -  String: sIn2
.head 7 -  String: sMsg
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If ( sIn1 != sIn2 )
.head 8 -  Call __LogAdd( eUnitTestStatus.Succeeded, 'Strings are not equal' )
.head 7 +  Else
.head 8 +  If ( NOT sMsg )
.head 9 -  Set sMsg = 'Strings are equal.
String 1 = "' || sIn1|| '"
String 2 = "' || sIn2 || '"'
.head 8 -  Call __LogAdd( eUnitTestStatus.Failed, sMsg )
.head 5 +  Function: AssertIsEmptyDate
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Date/Time: dtIn1
.head 7 -  String: sMsg
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If ( dtIn1 = DATETIME_Null )
.head 8 -  Call __LogAdd( eUnitTestStatus.Succeeded, 'Date/Time is DATETIME_Null' )
.head 7 +  Else
.head 8 +  If ( NOT sMsg )
.head 9 -  Set sMsg = 'Date/Time is not empty
Date/Time 1 = "' || SalFmtFormatDateTime( dtIn1, 'dd.MM.yyyy hhhh:mm:ss' )
.head 8 -  Call __LogAdd( eUnitTestStatus.Failed, sMsg )
.head 5 +  Function: AssertAreEqualDates
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Date/Time: dtIn1
.head 7 -  Date/Time: dtIn2
.head 7 -  String: sMsg
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If ( dtIn1 = dtIn2 )
.head 8 -  Call __LogAdd( eUnitTestStatus.Succeeded, 'Date/Time are equal' )
.head 7 +  Else
.head 8 +  If ( NOT sMsg )
.head 9 -  Set sMsg = 'Date/Time are not equal.
Date/Time 1 = "' || SalFmtFormatDateTime( dtIn1, 'dd.MM.yyyy hhhh:mm:ss' )|| '"
Date/Time 2 = "' || SalFmtFormatDateTime( dtIn2, 'dd.MM.yyyy hhhh:mm:ss' )
.head 8 -  Call __LogAdd( eUnitTestStatus.Failed, sMsg )
.head 5 +  Function: AssertAreNotEqualDates
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Date/Time: dtIn1
.head 7 -  Date/Time: dtIn2
.head 7 -  String: sMsg
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If ( dtIn1 != dtIn2 )
.head 8 -  Call __LogAdd( eUnitTestStatus.Succeeded, 'Date/Time are not equal' )
.head 7 +  Else
.head 8 +  If ( NOT sMsg )
.head 9 -  Set sMsg = 'Date/Time are equal.
Date/Time 1 = "' || SalFmtFormatDateTime( dtIn1, 'dd.MM.yyyy hhhh:mm:ss' )|| '"
Date/Time 2 = "' || SalFmtFormatDateTime( dtIn2, 'dd.MM.yyyy hhhh:mm:ss' )
.head 8 -  Call __LogAdd( eUnitTestStatus.Failed, sMsg )
.head 5 +  Function: AssertIsNumberNull
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nIn1
.head 7 -  String: sMsg
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If ( nIn1 = NUMBER_Null )
.head 8 -  Call __LogAdd( eUnitTestStatus.Succeeded, 'Numbers is NUMBER_Null' )
.head 7 +  Else
.head 8 +  If ( NOT sMsg )
.head 9 -  Set sMsg = 'Numbers is not NUMBER_Null
Number 1 = "' || SalNumberToStrX( nIn1, 10 ) || '"'
.head 8 -  Call __LogAdd( eUnitTestStatus.Failed, sMsg )
.head 5 +  Function: AssertAreEqualNumbers
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nIn1
.head 7 -  Number: nIn2
.head 7 -  String: sMsg
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If ( nIn1 = nIn2 )
.head 8 -  Call __LogAdd( eUnitTestStatus.Succeeded, 'Numbers are equal' )
.head 7 +  Else
.head 8 +  If ( NOT sMsg )
.head 9 -  Set sMsg = 'Numbers are not equal.
Number 1 = "' || SalNumberToStrX( nIn1, 10 ) || '"
Number 2 = "' || SalNumberToStrX( nIn2, 10 )
.head 8 -  Call __LogAdd( eUnitTestStatus.Failed, sMsg )
.head 5 +  Function: AssertAreNotEqualNumbers
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nIn1
.head 7 -  Number: nIn2
.head 7 -  String: sMsg
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If ( nIn1 != nIn2 )
.head 8 -  Call __LogAdd( eUnitTestStatus.Succeeded, 'Numbers are not equal' )
.head 7 +  Else
.head 8 +  If ( NOT sMsg )
.head 9 -  Set sMsg = 'Numbers are equal.
Number 1 = "' || SalNumberToStrX( nIn1, 10 ) || '"
Number 2 = "' || SalNumberToStrX( nIn2, 10 )
.head 8 -  Call __LogAdd( eUnitTestStatus.Failed, sMsg )
.head 5 +  Function: AssertIsHandleNull
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: Handle1
.head 7 -  String: sMsg
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If ( Handle1 = hWndNULL )
.head 8 -  Call __LogAdd( eUnitTestStatus.Succeeded, 'Handle is null' )
.head 7 +  Else
.head 8 +  If ( NOT sMsg )
.head 9 -  Set sMsg = 'Handle is not Null
Handle 1 = "' || SalNumberToStrX(SalWindowHandleToNumber( Handle1 ), 0) || 'h"'
.head 8 -  Call __LogAdd( eUnitTestStatus.Failed, sMsg )
.head 5 +  Function: AssertIsHandleNotNull
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: Handle1
.head 7 -  String: sMsg
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If ( Handle1 != hWndNULL )
.head 8 -  Call __LogAdd( eUnitTestStatus.Succeeded, 'Handle is not null' )
.head 7 +  Else
.head 8 +  If ( NOT sMsg )
.head 9 -  Set sMsg = 'Handle is Null
hWnd 1 = "' || SalNumberToStrX(SalWindowHandleToNumber( Handle1 ), 0) || 'h"'
.head 8 -  Call __LogAdd( eUnitTestStatus.Failed, sMsg )
.head 5 +  Function: AssertIsTrue
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: bIsTrue
.head 7 -  String: sMsg
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If ( bIsTrue )
.head 8 -  Call __LogAdd( eUnitTestStatus.Succeeded, 'Is true' )
.head 7 +  Else
.head 8 +  If ( NOT sMsg )
.head 9 -  Set sMsg = 'Is not true'
.head 8 -  Call __LogAdd( eUnitTestStatus.Failed, sMsg )
.head 5 +  Function: AssertIsFalse
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: bIsFalse
.head 7 -  String: sMsg
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If ( bIsFalse = FALSE )
.head 8 -  Call __LogAdd( eUnitTestStatus.Succeeded, 'Is false' )
.head 7 +  Else
.head 8 +  If ( NOT sMsg )
.head 9 -  Set sMsg = 'Is not false'
.head 8 -  Call __LogAdd( eUnitTestStatus.Failed, sMsg )
.head 5 +  Function: AssertFail
.head 6 -  Description: Fails always. E.g. Use it in testcode-sections that must not be reached or in not yet implemented testcode.
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sMsg
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If ( NOT sMsg )
.head 8 -  Set sMsg = 'This assert should not have been hit'
.head 7 -  Call __LogAdd( eUnitTestStatus.Failed, sMsg )
.head 3 +  Functional Class: structUnitTestLogItem
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nUnitTestStatus
.head 5 -  String: sClassName
.head 5 -  String: sFunctionName
.head 5 -  String: sMessage
.head 4 -  Functions
.head 3 +  Functional Class: UnitTestLog
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  FunctionalVar: acLogItems[*]
.head 6 -  Class: structUnitTestLogItem
.head 5 -  Number: nLogCount
.head 5 -  Window Handle: hWndNotify
.head 4 +  Functions
.head 5 +  Function: Add
.head 6 -  Description: Fills and appends an UnitTest logitem
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nUtStatus
.head 7 -  String: sClsName
.head 7 -  String: sFncName
.head 7 -  String: sMsg
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set acLogItems[nLogCount].nUnitTestStatus = nUtStatus
.head 7 -  Set acLogItems[nLogCount].sClassName = sClsName
.head 7 -  Set acLogItems[nLogCount].sFunctionName = sFncName
.head 7 -  Set acLogItems[nLogCount].sMessage = sMsg
.head 7 +  If ( hWndNotify )
.head 8 -  Call SalSendMsg( hWndNotify, SAM_NewUnitTestResult, nLogCount, 0 )
.head 7 -  Set nLogCount = nLogCount + 1
.head 7 -  Return TRUE
.head 5 +  Function: Reset
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalArraySetUpperBound( acLogItems, 1, -1 )
.head 7 -  Set nLogCount = 0
.head 7 -  Return TRUE
.head 5 +  Function: SetNotifyWindowHandle
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: hWnd
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set hWndNotify = hWnd
.head 3 +  Functional Class: UnitTestInternalFunctionTests
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: _UnitTestBase
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 +  Functions
.head 5 +  Function: StrReplaceSubstringX_ReplaceSameLength_CorrectString
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call AssertAreEqualStrings( StrReplaceSubstringX( 'abc123def', '123', '987' ), 'abc987def', '' )
.head 5 +  Function: StrReplaceSubstringX_ReplaceAtBeginning_CorrectString
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call AssertAreEqualStrings( StrReplaceSubstringX( 'abc123def', 'abc', 'ABC' ), 'ABC123def', '' )
.head 5 +  Function: StrReplaceSubstringX_ReplaceAtEnd_CorrectString
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call AssertAreEqualStrings( StrReplaceSubstringX( 'abc123def', 'def', 'xxx' ), 'abc123xxx', '' )
.head 5 +  Function: StrReplaceSubstringX_ReplaceDifferentLength_CorrectString
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call AssertAreEqualStrings( StrReplaceSubstringX( 'abc123def', '123', 'X' ), 'abcXdef', '' )
.head 5 +  Function: StrReplaceSubstringX_EmptyFind_ReturnsOriginal
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call AssertAreEqualStrings( StrReplaceSubstringX( 'abc123def', '', 'X' ), 'abc123def', '' )
.head 5 +  Function: StrReplaceSubstringX_EmptyReplace_CorrectString
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call AssertAreEqualStrings( StrReplaceSubstringX( 'abc123def', '123', '' ), 'abcdef', '' )
.head 5 +  Function: StrReplaceSubstringX_EmptyMain_Empty
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call AssertAreEqualStrings( StrReplaceSubstringX( '', '123', 'y' ), '', '' )
.head 5 -  !
.head 5 +  Function: StrReplaceEverySubtringX_ReplaceA_CorrectString
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call AssertAreEqualStrings( StrReplaceEverySubstringX('abacadaeaf', 'a', 'X'), 'XbXcXdXeXf', '' )
.head 5 +  Function: StrReplaceEverySubtringX_ReplaceEmptyWithEmpty_Original
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call AssertAreEqualStrings( StrReplaceEverySubstringX('abacadaeaf', '', ''), 'abacadaeaf', '' )
.head 5 +  Function: StrReplaceEverySubtringX_ReplaceAAWithA_CorrectString
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call AssertAreEqualStrings( StrReplaceEverySubstringX('AAAA', 'AA', 'A'), 'AA', '' )
.head 5 +  Function: StrReplaceEverySubtringX_ReplaceAWithABA_CorrectString
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call AssertAreEqualStrings( StrReplaceEverySubstringX('AAAA', 'A', 'ABA'), 'ABAABAABAABA', '' )
.head 5 -  !
.head 5 +  Function: EliminateWhitespacesX_AllWhitespaces_CorrectString
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call AssertAreEqualStrings( EliminateWhitespacesX('space tab	crlf
end'), 'spacetabcrlfend', '' )
.head 5 -  !
.head 5 +  Function: StripComment_NotCommented_ReturnEmpty
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sItemName
.head 6 +  Actions
.head 7 -  Set sItemName = 'GetContext'
.head 7 -  Call AssertIsEmptyString( StripComment( sItemName ), '' )
.head 5 +  Function: StripComment_Commented_ReturnsCorrectComment
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sItemName
.head 6 +  Actions
.head 7 -  Set sItemName = 'GetContext		! irgendein Kommentar '
.head 7 -  Call AssertAreEqualStrings( StripComment( sItemName),'irgendein Kommentar',  '' )
.head 5 +  Function: StripComment_Commented_ReturnsCorrectItemName
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sItemName
.head 6 +  Actions
.head 7 -  Set sItemName = 'GetContext		! irgendein Kommentar '
.head 7 -  Call StripComment( sItemName )
.head 7 -  Call AssertAreEqualStrings( sItemName, 'GetContext',  '' )
.head 5 +  Function: StripComment_CommentedWithWhitespace_ReturnsCorrectComment
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sItemName
.head 6 +  Actions
.head 7 -  Set sItemName = 'GetContext		! irgendein Kommentar
mit Zeilenumbruch '
.head 7 -  Call AssertAreEqualStrings( StripComment( sItemName ),'irgendein Kommentar
mit Zeilenumbruch',  '' )
.head 5 +  Function: GetContext
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return SalContextCurrent()
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton:
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 3 -  ActiveX:
.head 2 +  Application Actions
.head 3 +  On SAM_AppStartup
.head 4 -  Set bRunUnitTestInternalFunctionTests = TRUE
.head 1 +  Form Window: frmTDUnitTestContainer
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  Allow Child Docking? No
.head 3 -  Docking Orientation: All
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  15.133"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.643"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Just a container where dlgWindows (especially the modal ones) can be placed
so that they aren't modal any more
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Picture: picTests
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.517"
.head 5 -  Top: 0.333"
.head 5 -  Width:  2.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 -  Message Actions
.head 1 +  Form Window: frmTDUnitTestRunner
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: TDUnit Testrunner
.head 2 -  Icon File:
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  Allow Child Docking? No
.head 3 -  Docking Orientation: All
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  14.35"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 9.488"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbRunTests
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Run Tests
.head 4 -  Window Location and Size
.head 5 -  Left: 4.033"
.head 5 -  Top: 0.214"
.head 5 -  Width:  3.567"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.738"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call RunTests()
.head 3 +  Check Box: cbRunSlowTests
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Run SlowTests
.head 4 -  Window Location and Size
.head 5 -  Left: 4.033"
.head 5 -  Top: 2.202"
.head 5 -  Width:  2.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbRunIgnored
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Run Ignored Tests
.head 4 -  Window Location and Size
.head 5 -  Left: 4.033"
.head 5 -  Top: 2.476"
.head 5 -  Width:  3.233"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Child Table: tblUnitTestClasses
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.483"
.head 6 -  Top: 0.202"
.head 6 -  Width:  3.35"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.369"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 9
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: ClassName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Classname
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: UnitTestStatus	! __invisible
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: UnitTestStatus
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: Reset
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalTblReset( hWndForm )
.head 5 +  Function: AddRow
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sClassName
.head 7 -  Number: nUnitTestStatusNew
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRow
.head 7 -  Number: nUnitTestStatusOld
.head 7 -  Number: nColor
.head 6 +  Actions
.head 7 -  Set nRow = __FindRowByClassName( sClassName )
.head 7 +  If ( nRow = -1 )
.head 8 -  Set nRow = SalTblInsertRow( hWndForm, TBL_MaxRow )
.head 8 -  Call SalTblSetContext( hWndForm, nRow )
.head 8 -  Set ClassName = sClassName
.head 7 +  Else
.head 8 -  Call SalTblSetContext( hWndForm, nRow )
.head 8 -  Set nUnitTestStatusOld = UnitTestStatus
.head 8 -  Set nUnitTestStatusNew = __GetMostImportantStatus( nUnitTestStatusNew, nUnitTestStatusOld )
.head 7 -  Set UnitTestStatus = nUnitTestStatusNew
.head 7 -  Set nColor = UnitTestStatus2Color( nUnitTestStatusNew )
.head 7 -  Call SalTblSetCellTextColor( ClassName, nColor, FALSE )
.head 5 +  Function: __FindRowByClassName
.head 6 -  Description: return rownumber of row where classname is equal or -1
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  String: sClassName
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRow
.head 7 -  Number: nRowOld
.head 7 -  Boolean: bFound
.head 6 +  Actions
.head 7 -  Set nRowOld = SalTblQueryContext( hWndForm )
.head 7 +  While ( SalTblSetContext( hWndForm, nRow ) )
.head 8 +  If (ClassName = sClassName )
.head 9 -  Set bFound = TRUE
.head 9 -  Break
.head 8 -  Set nRow = nRow + 1
.head 7 -  Call SalTblSetContext( hWndForm, nRowOld )
.head 7 +  If ( bFound )
.head 8 -  Return nRow
.head 7 -  Return -1
.head 5 +  Function: __GetMostImportantStatus
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nStatus1
.head 7 -  Number: nStatus2
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If ( nStatus1 = nStatus2 )
.head 8 -  Return nStatus1
.head 7 +  If (nStatus1 = eUnitTestStatus.Neutral )
.head 8 -  ! Neutral hat niedrigste Prio
.head 8 -  Return nStatus2
.head 7 +  Else If ( nStatus1 = eUnitTestStatus.Succeeded )
.head 8 +  If ( (nStatus2 = eUnitTestStatus.Failed) OR (nStatus2 = eUnitTestStatus.Ignored) )
.head 9 -  Return nStatus2
.head 7 +  Else If ( nStatus1 = eUnitTestStatus.Failed )
.head 8 -  ! Failed hat höchste Prio
.head 8 -  Return nStatus1
.head 7 +  Else If ( nStatus1 = eUnitTestStatus.Ignored )
.head 8 +  If ( (nStatus2 = eUnitTestStatus.Failed) )
.head 9 -  Return nStatus2
.head 5 +  Function: ScrollToClass
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sClassName
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRow
.head 6 +  Actions
.head 7 +  If ( sClassName )
.head 8 -  Set nRow = __FindRowByClassName( sClassName )
.head 8 +  If ( nRow >= 0 )
.head 9 -  Call SalTblScroll( hWndForm, nRow, hWndNULL, TBL_AutoScroll )
.head 9 -  Call SalTblSetContext( hWndForm, nRow )
.head 9 -  Call SalTblSetFocusRow( hWndForm, nRow )
.head 5 +  Function: OnDoubleClick
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set cbClassFilter = TRUE
.head 7 -  Call ShowLog( ClassName, cbClassFilter )
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Call OnDoubleClick()
.head 5 +  On SAM_CreateComplete
.head 6 -  Call SalTblDefineRowHeader( hWndForm, '', 0, TBL_RowHdr_MarkEdits, hWndNULL )
.head 3 +  Check Box: cbClassFilter
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Classfilter on
.head 4 -  Window Location and Size
.head 5 -  Left: 0.5"
.head 5 -  Top: 3.571"
.head 5 -  Width:  3.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If ( MyValue )
.head 7 -  Call ShowLog( tblUnitTestClasses.ClassName, cbClassFilter )
.head 6 +  Else
.head 7 -  Call ShowLog( '', cbClassFilter )
.head 3 +  Child Table: tblUnitTestLog
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.45"
.head 6 -  Top: 3.857"
.head 6 -  Width:  13.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.631"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 9
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 10000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: ClassName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Class
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: FunctionName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Function
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.45"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: Message
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Message
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 2048
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.75"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: Status
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Status
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  5.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: AddRow
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  FunctionalVar: cLogItem
.head 8 -  Class: structUnitTestLogItem
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRow
.head 7 -  Number: nColor
.head 6 +  Actions
.head 7 -  Set nRow = SalTblInsertRow( hWndForm, TBL_MaxRow )
.head 7 -  Call SalTblSetContext( hWndForm, nRow )
.head 7 -  !
.head 7 -  Set nColor = UnitTestStatus2Color( cLogItem.nUnitTestStatus )
.head 7 -  Call SalTblSetCellTextColor( ClassName, nColor, FALSE )
.head 7 -  Call SalTblSetCellTextColor( FunctionName, nColor, FALSE )
.head 7 -  Call SalTblSetCellTextColor( Message, nColor, FALSE )
.head 7 -  !
.head 7 -  Set ClassName = cLogItem.sClassName
.head 7 -  Set FunctionName = cLogItem.sFunctionName
.head 7 -  Set Message  =cLogItem.sMessage
.head 7 -  Set Status = cLogItem.nUnitTestStatus
.head 5 +  Function: Reset
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalTblReset( hWndForm )
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_CreateComplete
.head 6 -  Call SalTblDefineRowHeader( hWndForm, '', 0, TBL_RowHdr_MarkEdits, hWndNULL )
.head 5 +  On SAM_TblDoDetails
.head 6 -  Call CheckOutFromLog()
.head 3 +  Data Field: dfClassName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.45"
.head 6 -  Top: 7.524"
.head 6 -  Width:  13.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 9
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfFunctionName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.45"
.head 6 -  Top: 7.798"
.head 6 -  Width:  13.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 9
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Multiline Field: mlMessage
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2048
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? No
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left: 0.45"
.head 6 -  Top: 8.071"
.head 6 -  Width:  13.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.917"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 9
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: RunTests
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 -  Set cbClassFilter = FALSE
.head 5 -  Set bSkipSlowTests = NOT cbRunSlowTests
.head 5 -  Set bOverrideIgnore = cbRunIgnored
.head 5 -  Call cLog.Reset(  )
.head 5 -  Call tblUnitTestLog.Reset(  )
.head 5 -  Call RunUnitTests( cLog, hWndForm )
.head 5 -  Call ShowLog( '', TRUE )
.head 5 -  Call SalWaitCursor( FALSE )
.head 3 +  Function: ShowLog
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sClassFilter
.head 5 -  Boolean: bShowFirstError
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nIdx
.head 5 -  Number: nRowFirstErrorOrIgnore
.head 5 -  String: sClassFirstErrorOrIgnore
.head 4 +  Actions
.head 5 -  Call tblUnitTestLog.Reset()
.head 5 -  Call tblUnitTestClasses.Reset(  )
.head 5 -  Set nRowFirstErrorOrIgnore = -1
.head 5 +  While (nIdx < cLog.nLogCount)
.head 6 +  If ( (NOT sClassFilter) OR (sClassFilter = cLog.acLogItems[nIdx].sClassName ) )
.head 7 -  Call tblUnitTestLog.AddRow( cLog.acLogItems[nIdx] )
.head 7 -  Call tblUnitTestClasses.AddRow( cLog.acLogItems[nIdx].sClassName, cLog.acLogItems[nIdx].nUnitTestStatus )
.head 7 +  If ( (nRowFirstErrorOrIgnore = -1)
AND (cLog.acLogItems[nIdx].nUnitTestStatus = eUnitTestStatus.Failed)
OR cLog.acLogItems[nIdx].nUnitTestStatus = eUnitTestStatus.Ignored )
.head 8 -  Set nRowFirstErrorOrIgnore = nIdx
.head 8 -  Set sClassFirstErrorOrIgnore = cLog.acLogItems[nIdx].sClassName
.head 6 -  Set nIdx = nIdx + 1
.head 5 +  If ( bShowFirstError AND (nRowFirstErrorOrIgnore >= 0) )
.head 6 -  Call SalTblScroll( tblUnitTestLog, nRowFirstErrorOrIgnore, hWndNULL, TBL_AutoScroll  )
.head 6 -  Call SalTblSetContext( tblUnitTestLog, nRowFirstErrorOrIgnore )
.head 6 -  Call SalTblSetFocusRow( tblUnitTestLog, nRowFirstErrorOrIgnore )
.head 6 -  Call tblUnitTestClasses.ScrollToClass( sClassFirstErrorOrIgnore )
.head 5 -  Call CheckOutFromLog(  )
.head 3 +  Function: ShowUnitTestClasses
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  FunctionalVar: acUnitTestClasses[*]
.head 6 -  Class: cdkClass
.head 5 -  Number: nCountUnitTestClasses
.head 5 -  Number: nIdx
.head 4 +  Actions
.head 5 -  Call tblUnitTestClasses.Reset(  )
.head 5 -  Set nCountUnitTestClasses = GetUnitTestClasses( acUnitTestClasses, OBJ_Null ) 
.head 5 +  While ( nIdx < nCountUnitTestClasses )
.head 6 -  Call tblUnitTestClasses.AddRow( acUnitTestClasses[nIdx].GetName(), eUnitTestStatus.Neutral )
.head 6 -  Set nIdx = nIdx + 1
.head 3 +  Function: OnCreateComplete
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowUnitTestClasses(  )
.head 5 -  Call RunTests( )
.head 3 +  Function: CheckOutFromLog
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nColor
.head 4 +  Actions
.head 5 -  Set dfClassName = tblUnitTestLog.ClassName
.head 5 -  Set dfFunctionName = tblUnitTestLog.FunctionName
.head 5 -  Set mlMessage = tblUnitTestLog.Message
.head 5 -  Set nColor = UnitTestStatus2Color( tblUnitTestLog.Status)
.head 5 -  Call SalColorSet( dfClassName, COLOR_IndexWindowText, nColor )
.head 5 -  Call SalColorSet( dfFunctionName, COLOR_IndexWindowText, nColor )
.head 5 -  Call SalColorSet( mlMessage, COLOR_IndexWindowText, nColor )
.head 3 +  Function: UnitTestStatus2Color
.head 4 -  Description: Returns a color constant apropriate for each eUnitStatus value
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nStatus
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If ( nStatus = eUnitTestStatus.Neutral )
.head 6 -  Return COLOR_Black
.head 5 +  Else If ( nStatus = eUnitTestStatus.Succeeded )
.head 6 -  Return COLOR_DarkGreen
.head 5 +  Else If ( nStatus = eUnitTestStatus.Failed )
.head 6 -  Return COLOR_DarkRed
.head 5 +  Else If ( nStatus = eUnitTestStatus.Ignored )
.head 6 -  Return COLOR_Salmon
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  FunctionalVar: cLog
.head 4 -  Class: UnitTestLog
.head 2 +  Message Actions
.head 3 +  On SAM_NewUnitTestResult
.head 4 -  Call tblUnitTestLog.AddRow( cLog.acLogItems[wParam] )
.head 3 +  On SAM_CreateComplete
.head 4 -  Call OnCreateComplete()
